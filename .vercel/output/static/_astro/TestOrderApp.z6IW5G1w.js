import{d as f,a as m,u as j,j as e,C as N,c as y}from"./api.dMCnM2hZ.js";import{r as o}from"./index.DYrVU9rO.js";function v(){const[s,u]=o.useState({customerName:"Test Customer",email:"test@example.com",phone:"+1234567890",orderType:"service",itemDescription:"Signature Mesh Re-string"}),[r,i]=o.useState(null),[n,c]=o.useState(!1),p=f(m.stripe.handleCheckoutCompleted),x=j(m.orders.getActiveOrders),h=async a=>{a.preventDefault(),c(!0),i(null);try{const l=await p({customerName:s.customerName,email:s.email,phone:s.phone||void 0,stripeSessionId:`test_session_${Date.now()}`,orderType:s.orderType,itemDescription:s.itemDescription});i({success:!0,orderId:l.orderId})}catch(l){i({success:!1,error:l.message||"Failed to create order"})}finally{c(!1)}},t=a=>{const{name:l,value:b}=a.target;u(g=>({...g,[l]:b}))},d=r?.orderId?x?.find(a=>a._id===r.orderId):null;return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Test Order Creation"}),e.jsx("p",{className:"text-slate-400 mb-8",children:"Test the Stripe webhook handler by creating orders directly"}),e.jsxs("form",{onSubmit:h,className:"bg-slate-800 border border-slate-700 p-6 rounded-2xl mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"customerName",className:"block text-white font-medium mb-2",children:"Customer Name"}),e.jsx("input",{type:"text",id:"customerName",name:"customerName",value:s.customerName,onChange:t,required:!0,className:"w-full px-4 py-2 bg-slate-900 border border-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-600"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"email",className:"block text-white font-medium mb-2",children:"Email"}),e.jsx("input",{type:"email",id:"email",name:"email",value:s.email,onChange:t,required:!0,className:"w-full px-4 py-2 bg-slate-900 border border-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-600"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"phone",className:"block text-white font-medium mb-2",children:"Phone (Optional)"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:s.phone,onChange:t,className:"w-full px-4 py-2 bg-slate-900 border border-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-600"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-white font-medium mb-2",children:"Order Type"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center text-white cursor-pointer",children:[e.jsx("input",{type:"radio",name:"orderType",value:"service",checked:s.orderType==="service",onChange:t,className:"mr-2 accent-purple-600"}),"Service"]}),e.jsxs("label",{className:"flex items-center text-white cursor-pointer",children:[e.jsx("input",{type:"radio",name:"orderType",value:"product",checked:s.orderType==="product",onChange:t,className:"mr-2 accent-purple-600"}),"Product"]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"itemDescription",className:"block text-white font-medium mb-2",children:"Item Description"}),e.jsx("textarea",{id:"itemDescription",name:"itemDescription",value:s.itemDescription,onChange:t,required:!0,rows:3,className:"w-full px-4 py-2 bg-slate-900 border border-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-600"})]}),e.jsx("button",{type:"submit",disabled:n,className:"w-full py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",children:n?"Creating Order...":"Create Test Order"})]}),r&&e.jsx("div",{className:`p-6 rounded-2xl ${r.success?"bg-green-900/20 border border-green-700":"bg-red-900/20 border border-red-700"}`,children:r.success?e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-green-400 font-bold text-xl mb-2",children:"✓ Order Created Successfully!"}),e.jsxs("p",{className:"text-slate-300 mb-2",children:["Order ID:"," ",e.jsx("code",{className:"bg-black/30 px-2 py-1 rounded text-xs",children:r.orderId})]}),e.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"⚠️ Use the full Order ID above in URLs, not the pickup code"}),d&&e.jsxs("p",{className:"text-slate-300 mb-4",children:["Pickup Code:"," ",e.jsx("span",{className:"text-pink-500 font-mono text-2xl font-bold",children:d.pickupCode})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("a",{href:`/order/${r.orderId}`,className:"inline-block px-4 py-2 bg-purple-600 text-white rounded-lg hover:opacity-90",children:"View Order Page"}),e.jsx("a",{href:"/internal/admin",className:"inline-block px-4 py-2 bg-slate-600 text-white rounded-lg hover:opacity-90",children:"View Dashboard"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-red-400 font-bold text-xl mb-2",children:"✗ Order Creation Failed"}),e.jsxs("p",{className:"text-slate-300",children:["Error: ",r.error]})]})}),e.jsxs("div",{className:"mt-8 bg-slate-800/50 border border-slate-700 p-6 rounded-2xl",children:[e.jsx("h3",{className:"text-white font-bold mb-2",children:"How This Works"}),e.jsxs("ul",{className:"text-slate-400 space-y-2 text-sm",children:[e.jsxs("li",{children:["• This page calls"," ",e.jsx("code",{className:"bg-black/30 px-1",children:"api.stripe.handleCheckoutCompleted"})," ","directly"]}),e.jsx("li",{children:"• Bypasses webhook signature verification for testing"}),e.jsx("li",{children:"• Generates a fake Stripe session ID"}),e.jsx("li",{children:'• Order is created with status "paid"'}),e.jsx("li",{children:"• View created orders on the dashboard"})]})]})]})})}const w=new N("https://kindly-beagle-851.convex.cloud");function D(){return e.jsx(y,{client:w,children:e.jsx(v,{})})}export{D as default};
